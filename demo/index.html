<!DOCTYPE html>
<html>
<head>
    <title>World Topo Maps</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>


    <link type="text/css" href="style.css" rel="stylesheet" media="all" />

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>

    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?libraries=drawing&sensor=false"></script>


    <script type="text/javascript" src="../js/wtmap.js"></script>
    <script type="text/javascript" src="../js/swisstopo.js"></script>
    <script type="text/javascript" src="../js/igne.js"></script>
    <script type="text/javascript" src="../js/gmap.js"></script>
    <script type="text/javascript" src="../js/ignf.js"></script>
    <script type="text/javascript" src="../js/manager.js"></script>


    <script type="text/javascript">

        jQuery(function($) {

            $('#coord').draggable({
                containment: 'body',
                opacity: 0.4
            });

            var gmap = new google.maps.Map(
                document.getElementById('gmap'),
                {
                    zoom: 6,
                    center: new google.maps.LatLng(45, 5),
                    mapTypeId: google.maps.MapTypeId.ROADMAP,
                    noClear: true
                }
            );

            var gAdapter = new WTMap.Adapter.GMap(gmap);

            WTMap.Manager(
                gAdapter,
                [
                    new WTMap.getIgnFMap({
                        drm: WTMap.IgnGeoDrm("5813011417347961637"),
                        logos: { map: '../img/logo_ign.gif' }
                    }),
                    new WTMap.getIgnEMap({
                        logo: '../img/logo_igne.gif'
                    }),
                    new WTMap.getSwissTopoMap()
                ]
            );

            google.maps.event.addListener(gmap, 'mousemove', function(ll) {
                $('#coord')
                    .find('#lat').text(ll.latLng.lat()).end()
                    .find('#lng').text(ll.latLng.lng()).end()
                    .find('#zoom').text(gmap.getZoom()).end()
                ;
            });

            $('#pos')
                .on('click', 'li', function() {
                    gAdapter.setCenter({lat: $(this).data('lat'), lng: $(this).data('lng')});
                })
                .find('li').each(function() {
                    var text = $(this).text();
                    $(this).attr('title', $(this).data('lat') + ', ' + $(this).data('lng'));
                    new google.maps.Marker({
                        position: new google.maps.LatLng($(this).data('lat'), $(this).data('lng')),
                        map: gmap,
                        title: text
                    });
                })
            ;
        });

    </script>

</head>

<body>

    <div id="gmap" class="map_canvas"></div>

    <div id="coord">
        <div id="drag-handle"></div>
        <p>LatLng = (<span id="lat"></span>, <span id="lng"></span>)</p>
        <p>Zoom = <span id="zoom"></span></p>
        <ul id="pos">
            <li data-lat="45.1888" data-lng="5.8053" >Meylan</li>
            <li data-lat="-20.8723" data-lng="55.4496">St Denis</li>
            <li data-lat="-21.3659" data-lng="55.7741">St Philippe</li>
            <li data-lat="46.2063" data-lng="6.1389">Geneve</li>
            <li data-lat="46.9540" data-lng="7.4707">Bern</li>
            <li data-lat="-22.2744" data-lng="166.4546">Noumea</li>
            <li data-lat="41.3885" data-lng="2.1869">Barcelone</li>
            <li data-lat="40.4171" data-lng="-3.6839">Madrid</li>
        </ul>
    </div>


</body>
</html>
